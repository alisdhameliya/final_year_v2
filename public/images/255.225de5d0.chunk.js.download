(this.webpackJsonpdhiwise=this.webpackJsonpdhiwise||[]).push([[255],{2987:function(y,M,n){(function(R,a){y.exports=a()})(this,function(){"use strict";return function(R,a){a.prototype.isSameOrAfter=function(v,I){return this.isSame(v,I)||this.isAfter(v,I)}}})},3874:function(y,M,n){"use strict";n.r(M);var R=n(0),a=n.n(R),v=n(330),I=n.n(v),i=n(45),p=n(385),st=n.n(p),_=n(25),H=n(75),A=n.n(H),B=n(114),ct=n.n(B),Y=n(116),J=n.n(Y),N=n(6),dt=n.n(N),u=n(4),s=n(61),X=n(97),c=n(11),Q=n(264),V=n(182),$=n(31),W=n(57),K=n(2),G=n(610),z=n(68),Z=n(284),j=(f,l,d)=>new Promise((h,O)=>{var D=t=>{try{m(d.next(t))}catch(P){O(P)}},T=t=>{try{m(d.throw(t))}catch(P){O(P)}},m=t=>t.done?h(t.value):Promise.resolve(t.value).then(D,T);m((d=d.apply(f,l)).next())});const w=n(2987);A.a.extend(w);function k({component:f,path:l,moduleId:d,action:h="VIEW",isOnboardingUrl:O=!1}){var D;const T=Object(_.e)(),m=Object(i.g)(),{userData:t}=Object(X.a)(),P=Object(_.f)(e=>e.auth.userType||0),q=Object(_.f)(e=>e.auth.expireTrialPlan||!1),E=c.a.get(u.E),tt=Object(_.f)(e=>e.auth.userPermission||[]),et=Object(_.f)(e=>e.auth.isWorkspaceDeleted||!1),nt=Object(_.f)(e=>e.auth.defaultRedirectUrl),[at,lt]=Object($.c)(),{currentApplicationCode:L,currentApplicationId:ot}=at,o=Object(i.h)(),U=new URLSearchParams(o.search),S=U.get("figmaRedirectPage"),{hasFeature:F}=Object(B.useFlagsmith)(),C=F(W.f.FIGMA_PLUGIN_ONBOARDING),it=()=>{setTimeout(()=>{var e;l.includes(G.a)&&!F((e=W.a[L])==null?void 0:e.REACT_ADMIN_PANEL)&&m.push("*")},0)},rt=()=>j(this,null,function*(){try{yield J.a.identify(t==null?void 0:t.email,{email:t==null?void 0:t.email})}catch(e){console.warn("flagsmith")}it()});if(a.a.useEffect(()=>j(this,null,function*(){L===K.b.reactAdmin&&(yield rt())}),[t==null?void 0:t.email]),a.a.useEffect(()=>{if(t!=null&&t.email)try{window.clarity("identify",t==null?void 0:t.email),window.clarity("set","email",t==null?void 0:t.email)}catch(e){console.error("Error while setting clarity user id",e)}},[t==null?void 0:t.email]),a.a.useEffect(()=>{var e,r,b,x;(r=(e=document.getElementsByTagName("flt-glass-pane"))==null?void 0:e[0])!=null&&r.style&&(document.getElementsByTagName("flt-glass-pane")[0].style.display="none"),(x=(b=document.getElementsByTagName("flutter-view"))==null?void 0:b[0])!=null&&x.style&&(document.getElementsByTagName("flutter-view")[0].style.display="none")},[l]),Object(N.last)(l.split("/"))===":appId"&&!ot)return a.a.createElement(i.a,{to:"/dashboard"});if(L!==K.b.reactAdmin&&l.includes(G.a))return a.a.createElement(i.a,{to:"*"});if(l==="/figma-authentication"&&!E&&c.a.set("FIGMA_PLUGIN_REDIRECTION",(o==null?void 0:o.pathname)+(o==null?void 0:o.search)),l==="/figmaPluginCode"&&!E&&c.a.set("FIGMA_PLUGIN_REDIRECTION",(o==null?void 0:o.pathname)+(o==null?void 0:o.search)),l==="/figmaPluginApp"&&!E&&c.a.set(u.j,(o==null?void 0:o.pathname)+(o==null?void 0:o.search)),l==="/open-code-view"&&!E&&c.a.set(u.c,(o==null?void 0:o.pathname)+(o==null?void 0:o.search)),l==="/account/figma-list"&&!E&&c.a.set("FIGMA_LIST_REDIRECTION","/account/figma-list"),["/select-screen-app","/template-category-app"].includes(l)&&!E){c.a.set(u.H,o==null?void 0:o.pathname);const e=o.search,r=U.get("ref");(e.includes("utm_source")||e.includes("utm_medium")||e.includes("utm_campaign"))&&c.a.set(u.G,e),r&&c.a.set(u.A,r)}if(!E)return["signin","sign-up"].includes(S)?a.a.createElement(i.a,{to:`/${S}`}):a.a.createElement(i.a,{to:"/sign-up"});c.a.get("TOKEN_EXPIRY")&&A()().isSameOrAfter(A()(c.a.get("TOKEN_EXPIRY")))&&(T({type:"LOGOUT"}),lt(Object(z.d)())),console.log("here, protected route");const g=Object(Z.a)(U);if(console.log("connectedWithIntelliJUrl",g),l!=="/connected-with-wisegpt"&&(g==null?void 0:g.length))return a.a.createElement(i.a,{to:g});if((t==null?void 0:t._id)&&(t==null?void 0:t.step)&&(t==null?void 0:t.step)<=s.f.FIGMA_PLUGIN_AUTH_REDIRECT.id&&!O){const e=I()(Object.values(s.f),{id:t.step});let r=e!=null&&e.link?e==null?void 0:e.link:"/dashboard";return console.log("condition with < 9"),!e&&s.f.ONBOARDING.id<=(t==null?void 0:t.step)<s.f.SELECT_TECHNOLOGY.id&&(r="/onboarding"),r==="/dashboard"&&(r=nt),(t==null?void 0:t.step)===s.f.FIGMA_PLUGIN_AUTH_REDIRECT.id&&c.a.get("FIGMA_PLUGIN_REDIRECTION")&&(r=c.a.get("FIGMA_PLUGIN_REDIRECTION")),(t==null?void 0:t.step)===s.f.FIGMA_PLUGIN_AUTH_REDIRECT.id&&o.search.includes("figmaPluginCode=true")&&(r=o.pathname+o.search),(t==null?void 0:t.step)===s.f.FIGMA_PLUGIN_AUTH_REDIRECT.id&&r==="/dashboard"&&(r="/onboarding"),C&&l==="/figma-authentication"&&s.f.ONBOARDING.id<=(t==null?void 0:t.step)&&(r="/onboarding"),a.a.createElement(i.a,{to:r})}if(C&&l==="/figma-authentication"&&s.f.ONBOARDING.id<=(t==null?void 0:t.step))return a.a.createElement(i.a,{to:"/onboarding"});if(C&&l==="/figmaPluginApp"&&s.f.ONBOARDING.id<=(t==null?void 0:t.step))return a.a.createElement(i.a,{to:"/onboarding"});if(l==="/onboarding"&&(t==null?void 0:t.step)===s.f.FINAL.id)return a.a.createElement(i.a,{to:"/dashboard"});if((t==null?void 0:t.step)===s.f.SELECT_TECHNOLOGY.id&&!O)return a.a.createElement(i.a,{to:"/onboarding"});if(q&&!s.a.includes(l))return P===s.e.PRIMARY?a.a.createElement(i.a,{to:"/upgrade-your-plan"}):a.a.createElement(i.a,{to:"/developer-plan"});if(d){const e=(D=tt.find(r=>r.module===d))==null?void 0:D.actions;if(!e||!e[h])return t!=null&&t._id?a.a.createElement(i.a,{to:"*"}):(localStorage.clear(),a.a.createElement(i.a,{to:"/signIn"}))}return et&&["/new","/technology-step","/technology-select"].includes(l)?a.a.createElement(i.a,{to:"*"}):!!(t!=null&&t._id)&&!!E?(console.log("redect why?",l),a.a.createElement(i.b,{component:f,path:l})):a.a.createElement(i.a,{to:"/sign-up"})}M.default=Object(p.withErrorBoundary)(k,{FallbackComponent:Q.a,onError(f,l){const d={errorLog:f.toString(),componentStack:l==null?void 0:l.componentStack,route:window.location.pathname};Object(V.a)(d)},resetKeys:[Math.random()]})}}]);
